## 修正版 要件定義書

## 1. プロジェクト概要

オンラインのECサイトを作成します。これはPDF形式のファイルの販売を行うシンプルなサイトです。

## 2. 目的と背景

AI駆動開発の実践例として、実際にECサイトを作成します。売上やアクセスは小規模ですが、本番で利用できるレベルのECサイトの構築が必要です。

## 3. スコープ

MVPです。初期リリースの段階で販売する本(PDF)の数は10程度です。

## 4-1. 機能一覧

| 機能名 | 機能の概要説明 | 主な利用者 | 入力情報 | 出力情報 | 処理の流れ |
|---|---|---|---|---|---|
| 商品一覧表示 | 販売中のPDFファイルを一覧表示する | 顧客 | なし | PDFファイルの一覧（タイトル、著者、価格、表紙画像、在庫状況など） | データベースから商品情報を取得し、一覧表示する |
| 商品詳細表示 | 選択されたPDFファイルの詳細情報を表示する | 顧客 | 商品ID | 商品の詳細情報（タイトル、著者、価格、表紙画像、商品説明、在庫状況など） | 商品IDに基づいてデータベースから商品情報を取得し、表示する |
| 検索機能 | キーワードでPDFファイルを検索する | 顧客 | 検索キーワード | 検索結果に合致するPDFファイルの一覧 | 入力されたキーワードに基づいてデータベースを検索し、結果を表示する |
| カート機能 | 購入予定の商品をカートに追加する | 顧客 | 商品ID | カートに追加された商品情報 | 商品IDをカート情報に追加する。在庫状況を確認し、在庫不足の場合はエラーメッセージを表示する |
| 注文処理 | カート内の商品を購入する | 顧客 | 顧客情報（氏名、住所、メールアドレスなど）、支払い情報 | 注文完了メッセージ、注文確認メール | 顧客情報と注文内容をデータベースに登録し、決済処理を行う。在庫数を減らす処理を行う |
| 決済機能 | 注文に対する支払い処理を行う | 顧客 | 支払い情報 | 決済完了メッセージ | 決済代行サービスと連携し、支払い処理を行う |
| マイページ | 注文履歴や顧客情報の確認・変更を行う | 顧客 | 顧客ID | 注文履歴、顧客情報 | 顧客IDに基づいてデータベースから情報を取得し、表示する |
| 商品管理 | 商品情報の登録・編集・削除を行う | 管理者 | 商品情報（タイトル、著者、価格、表紙画像、商品説明、PDFファイル、在庫数など） | 登録・編集・削除完了メッセージ | データベースの商品情報を操作する |

## 4-2. 画面一覧

| 画面名 | 画面の目的 | 主な利用者 | 表示する主な情報 | 主な操作項目 | 遷移先の画面 |
|---|---|---|---|---|---|
| トップページ | サイトの入り口、新着商品やおすすめ商品を表示 | 顧客 | 新着商品、おすすめ商品、サイト紹介など | 商品詳細ページへのリンク、検索窓 | 商品詳細ページ、検索結果ページ |
| 商品一覧ページ | 販売中のPDFファイルを一覧表示 | 顧客 | PDFファイルの一覧（タイトル、著者、価格、表紙画像、在庫状況など） | 商品詳細ページへのリンク、ソート機能、絞り込み機能 | 商品詳細ページ |
| 商品詳細ページ | 選択されたPDFファイルの詳細情報を表示 | 顧客 | 商品の詳細情報（タイトル、著者、価格、表紙画像、商品説明、在庫状況など） | カートに追加ボタン（在庫状況により表示/非表示） | カートページ |
| 検索結果ページ | 検索キーワードに合致するPDFファイルを一覧表示 | 顧客 | 検索結果に合致するPDFファイルの一覧 | 商品詳細ページへのリンク、ソート機能、絞り込み機能 | 商品詳細ページ |
| カートページ | 購入予定の商品を表示 | 顧客 | カートに追加された商品情報、合計金額、在庫状況 | 数量変更、商品削除、注文手続きへ進むボタン | 注文確認ページ |
| 注文確認ページ | 注文内容を確認 | 顧客 | 注文商品、顧客情報、支払い方法、合計金額、在庫状況 | 注文確定ボタン、注文内容変更ボタン | 注文完了ページ |
| 注文完了ページ | 注文完了を通知 | 顧客 | 注文番号、注文完了メッセージ | マイページへのリンク | マイページ |
| マイページ | 注文履歴や顧客情報の確認・変更 | 顧客 | 注文履歴、顧客情報 | 注文詳細ページへのリンク、顧客情報変更ページへのリンク | 注文詳細ページ、顧客情報変更ページ |
| ログインページ | 顧客がログインする | 顧客 | ログインフォーム | ログインボタン、新規登録ページへのリンク | トップページ、マイページ |
| 新規登録ページ | 新規顧客がアカウントを作成する | 顧客 | 新規登録フォーム | 登録ボタン | ログインページ |
| 商品管理ページ | 商品情報の登録・編集・削除を行う | 管理者 | 商品一覧、商品登録フォーム、商品編集フォーム | 商品登録ボタン、商品編集ボタン、商品削除ボタン | 商品管理ページ |


**変更点:**

* **在庫状況の表示:** 商品一覧、商品詳細、カート、注文確認ページに在庫状況を表示するようにしました。
* **カート機能の在庫チェック:** カートに追加する際に在庫状況を確認し、在庫不足の場合はエラーメッセージを表示するようにしました。
* **注文処理時の在庫更新:** 注文処理時に在庫数を減らす処理を追加しました。
* **商品管理ページの在庫管理:** 商品管理ページで在庫数を管理できるようにしました。

この要件定義書は初期段階のものであり、開発の進捗に合わせて更新される可能性があります。